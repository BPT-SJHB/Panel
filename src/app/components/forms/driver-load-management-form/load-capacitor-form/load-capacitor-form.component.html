<div class="grid grid-cols-12 gap-5">
  <app-search-auto-complete-factory
    class="col-span-12 md:col-span-6"
    [config]="autoCompleteAnnouncementGroup"
    [addonWidth]="addonWidth"
  >
  </app-search-auto-complete-factory>

  <app-search-auto-complete-factory
    class="col-span-12 md:col-span-6"
    [config]="autoCompleteSubAnnouncementGroup"
    [addonWidth]="addonWidth"
  >
  </app-search-auto-complete-factory>

  <app-select-input
    [label]="appTitle.inputs.loads.loadStatus"
    [placeholder]="appTitle.getPlaceholder('loadStatus')"
    class="col-span-12 md:col-span-6"
    [options]="loadStatusOptions()"
    [addonWidth]="addonWidth"
    [control]="this.ctrl('loadStatusId')"
  />

  <app-button
    class="col-span-12 mt-2 md:flex md:justify-end"
    styleClass="w-full md:w-40 lg:w-48"
    (onClick)="loadDriverLoads()"
    [disabled]="this.searchLoadsForm.invalid"
    severity="info"
  >
    {{ appTitle.buttons.seeLoads }}
  </app-button>
</div>

<div class="flex flex-wrap flex-col items-center justify-center mt-20">
  @for (province of driverLoads(); track $index) {
    <p-panel
      [header]="province.ProvinceName"
      [toggleable]="true"
      class="mb-4 w-full"
      [collapsed]="true"
    >
      <div
        class="flex flex-col justify-center items-center lg:flex-row lg:flex-wrap lg:justify-around"
      >
        @for (loads of province.myLoads; track $index) {
          <p-card
            [header]="'کد بار: ' + loads.LoadId"
            class="w-[95%] sm:w-[90%] min-w-[200px] max-w-[450px] mb-3 shadow-md rounded-2xl bg-emphasis"
          >
            <div class="flex flex-col gap-3 text-sm">
              <!-- مسیر بار -->
              <div class="flex flex-row gap-x-4 flex-wrap justify-between">
                <span>مبدا: {{ loads.SoureCityTitle }}</span>
                <span>مقصد: {{ loads.TargetCityTitle }}</span>
              </div>

              <!-- جزئیات بار -->
              <div class="flex flex-row gap-x-4 flex-wrap justify-between">
                <span>کالا: {{ loads.GoodTitle }}</span>
                <span>تناژ: {{ loads.Tonaj }}</span>
              </div>

              <div class="flex flex-row gap-x-4 flex-wrap justify-between">
                <span>محل بارگیری: {{ loads.LoadingPlaceTitle }}</span>
                <span>محل تخلیه: {{ loads.DischargingPlaceTitle }}</span>
              </div>

              <!-- شرکت و کاربر -->
              <div class="flex flex-col">
                <div class="flex flex-row gap-x-4 flex-wrap justify-between">
                  <span>شرکت حمل‌ونقل: {{ loads.TCTitle }}</span>
                  <span>شماره تلفن : -</span>
                </div>
              </div>

              <!-- گیرنده -->
              <div class="flex flex-col border-t pt-2">
                <span>گیرنده: {{ loads.Recipient }}</span>
                <span>آدرس: {{ loads.Address }}</span>
                <span>توضیحات: {{ loads.Description }}</span>
                <span>پارامتر های موثر: {{ loads.TPTParamsJoint }} </span>
              </div>

              <!-- مالی -->
              <div
                class="flex flex-row justify-between flex-wrap gap-x-4 border-t pt-2"
              >
                <span>تعرفه: {{ loads.Tariff }}</span>
                <span>تعداد کل: {{ loads.Total }}</span>
              </div>
            </div>

            <div class="flex justify-center mt-8">
              <app-button
                class="col-span-12 my-2"
                styleClass="w-32 md:w-40 lg:w-48"
                (onClick)="allocateLoad(loads.LoadId)"
                [disabled]="this.searchLoadsForm.invalid"
              >
                {{ appTitle.buttons.allocateLoad }}
              </app-button>
            </div>
          </p-card>
        }
      </div>
    </p-panel>
  } @empty {
    <p-card class="w-full my-4 shadow-sm">
      <div
        class="text-center text-color-emphasis text-sm flex items-center justify-center"
      >
        رکوردی برای نمایش وجود ندارد
      </div>
    </p-card>
  }
</div>
