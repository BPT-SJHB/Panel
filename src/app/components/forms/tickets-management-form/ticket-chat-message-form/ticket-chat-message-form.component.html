<!-- Chat Container -->
<div
  class="w-full h-[600px] rounded-xl shadow-md flex flex-col overflow-hidden"
>
  <!-- Messages Scrollable Area -->
  <div class="flex-1 overflow-y-auto p-4 flex flex-col gap-8" #chatContainer>
    @for (group of groupChats(); track $index) {
      <!-- Date separator -->
      <div class="text-center font-medium text-gray-500">
        {{ group.date }}
      </div>

      <!-- Chats -->
      <div class="space-y-3">
        @for (chat of group.messages; track $index) {
          <div
            class="flex flex-col"
            [ngClass]="{
              'items-end': !isSender(chat.senderId),
              'items-start': isSender(chat.senderId),
            }"
          >
            <!-- Bubble -->
            <div
              class="whitespace-pre-line px-4 py-2 rounded-xl max-w-[70%] break-words"
              [ngClass]="{
                'bg-primary/10 text-primary': isSender(chat.senderId),
                'bg-gray-100 text-gray-800': !isSender(chat.senderId),
              }"
            >
              {{ chat.message }}
            </div>
            <!-- Time -->
            <span class="text-xs text-gray-400 mt-1">
              {{ chat.time }}
            </span>
          </div>
        }
      </div>
    }
  </div>

  <!-- Chat Input -->
  <div class="flex items-center justify-center gap-4 p-3 border-t">
    <textarea
      #chatInput
      [formControl]="ctrl('message')"
      placeholder="پیام خود را تایپ کنید..."
      rows="1"
      class="flex-1 p-2 border rounded-lg resize-none overflow-hidden focus:ring focus:ring-primary/50"
      (input)="autoResize($event)"
    ></textarea>

    <app-button
      (onClick)="sendMessage()"
      severity="primary"
      [rounded]="true"
      styleClass="py-2.5 px-2.5"
      severity="info"
      icon="pi pi-send"
    >
    </app-button>
  </div>
</div>
