<!-- ðŸ” Search Input -->
<div class="w-full">
  <app-search-input
    class="w-full"
    [placeholder]="
      'Ø¹Ù†ÙˆØ§Ù† ' + appTitle.getPlaceholder('loadAnnouncementSubGroupTitle')
    "
    [staticData]="announcementsSubGroup"
    [itemMatchesQuery]="filterAnnouncementsSubGroup"
    [autoTriggerSearch]="true"
    [fallbackToAllWhenQueryShort]="true"
    [minSearchLength]="2"
    [control]="searchControl"
    (searchResult)="handleSearch($event)"
  />
</div>

<!-- ðŸ“‹ SubGroup Table -->
<app-table
  [enableCaptionButton]="true"
  (clickCaptionButton)="onNew()"
  [columns]="columns"
  [rows]="displayAnnouncementsSubGroup"
>
  <!-- Header with New Button -->
  <!-- Table Header -->
  <ng-template #caption>
    <div>
      <app-button
        [label]="appTitle.buttons.add.addRecord"
        size="small"
        styleClass="w-20 md:w-30 py-2"
        (click)="onNew()"
      ></app-button>
    </div>
  </ng-template>

  <ng-template #header let-columns>
    <tr>
      @for (col of columns; track $index) {
        <th>{{ col }}</th>
      }
    </tr>
  </ng-template>

  <!-- Table Body -->
  <ng-template #body let-rowData>
    <tr>
      <td>{{ rowData.AnnouncementSGId }}</td>

      <td>
        <app-button
          icon="pi pi-pencil"
          severity="info"
          variant="text"
          [disabled]="loading"
          (click)="onEdit(rowData)"
        />
      </td>

      <td>
        <app-button
          icon="pi pi-trash"
          severity="danger"
          variant="text"
          [disabled]="loading"
          (click)="onDelete(rowData)"
        />
      </td>

      <td>{{ rowData.AnnouncementSGTitle }}</td>

      <td>
        <i
          class="pi"
          [ngClass]="
            rowData.Active
              ? 'pi-check-circle text-green-500'
              : 'pi-times-circle text-red-500'
          "
        ></i>
      </td>
    </tr>
  </ng-template>
</app-table>

<!-- ðŸ“ Dialog for Add/Edit -->
<p-dialog
  draggable="false"
  [header]="headerTitle"
  [modal]="true"
  [style]="{ width: '30rem', maxWidth: '100%' }"
  maskStyleClass="px-4"
  [(visible)]="formDialogVisible"
  (onHide)="closeForm()"
>
  <form
    class="grid grid-cols-12 gap-4"
    [formGroup]="announcementSubGroupForm"
    [class.pointer-events-none]="loading"
    [class.opacity-60]="loading"
  >
    <div class="grid grid-cols-12 col-span-12 gap-4">
      <app-text-input
        class="col-span-12"
        [label]="appTitle.inputs.global.id"
        validationField="id"
        addonWidth="5rem"
        [readOnly]="true"
        [disabled]="true"
        [control]="AnnouncementSGId"
      />

      <app-text-input
        class="col-span-12"
        [label]="appTitle.inputs.global.title"
        [placeholder]="appTitle.getPlaceholder('globalTitlePlaceholder')"
        validationField="title"
        addonWidth="5rem"
        [control]="AnnouncementSGTitle"
      />

      <div class="flex col-span-12 px-4">
        <app-toggle-switch-input
          [label]="appTitle.toggleSwitches.status"
          [control]="AnnouncementActive"
          [readonly]="!isFormEditable()"
        />
      </div>
    </div>

    <div class="flex col-span-12 justify-end">
      <app-button
        [label]="appTitle.buttons.saveAndEdit"
        [disabled]="announcementSubGroupForm.invalid || loading"
        (click)="registerOrEdit()"
      />
    </div>
  </form>
</p-dialog>
