<p-confirm-dialog />

<app-search-input
  placeholder="قسمتی از نام را کنید."
  [asyncSearchFn]="searchLADPlace"
  [itemMatchesQuery]="filterLADPlace"
  (searchResult)="handelSearchLADPlaces($event)"
/>

<p-table
  class="col-span-12"
  styleClass="overflow-x-auto"
  [columns]="cols"
  [value]="ladPlaces"
  [tableStyle]="tableUi.tableStyle"
  [paginator]="tableUi.paginator"
  [paginatorLocale]="tableUi.paginatorLocale"
  [rows]="tableUi.rows"
  [rowsPerPageOptions]="tableUi.rowsPerPageOptions"
>
  <ng-template #caption>
    <div class="flex items-center justify-between">
      <p-button
        (click)="onNew()"
        label="جدید"
        size="small"
        styleClass="px-6 md:px-8 py-1"
      />
    </div>
  </ng-template>

  <ng-template #header let-columns>
    <tr>
      @for (col of columns; track $index) {
      <th>{{ col }}</th>
      }
    </tr>
  </ng-template>

  <ng-template #body let-rowData>
    <tr>
      <td>{{ rowData.LADPlaceId }}</td>

      <td (click)="onEdit(rowData)">
        <p-button
          [disabled]="loading"
          icon="pi pi-pencil"
          severity="info"
          variant="text"
        ></p-button>
      </td>

      <td (click)="onDelete(rowData)">
        <p-button
          icon="pi pi-trash"
          severity="danger"
          variant="text"
          [disabled]="loading"
        ></p-button>
      </td>

      <td>{{ rowData.LADPlaceTitle }}</td>

      <td>
        <i
          class="pi"
          [ngClass]="
            rowData.LoadingActive
              ? 'pi-check-circle text-green-500'
              : 'pi-times-circle text-red-500'
          "
        ></i>
      </td>

      <td>
        <i
          class="pi"
          [ngClass]="
            rowData.DischargingActive
              ? 'pi-check-circle text-green-500'
              : 'pi-times-circle text-red-500'
          "
        ></i>
      </td>

      <td>{{ rowData.LADPlaceTel }}</td>
      <td>{{ rowData.LADPlaceAddress }}</td>
    </tr>
  </ng-template>
</p-table>

<p-dialog
  draggable="false"
  [header]="headerTitle"
  [modal]="true"
  (onHide)="onCloseDialog()"
  [(visible)]="formDialogVisible"
  maskStyleClass="px-4"
  [style]="{ width: '30rem', maxWidth: '100%' }"
>
  <form
    class="grid grid-cols-12 gap-4"
    (ngSubmit)="registerOrEdit()"
    [class.pointer-events-none]="loading"
    [class.opacity-60]="loading"
    [formGroup]="ladPlacesForm"
  >
    <div class="grid grid-cols-12 col-span-12 gap-4">
      <app-text-input
        [readOnly]="true"
        [disabled]="true"
        [control]="ladPlacesId"
        icon="pi pi-id-card"
        validationField="id"
        class="col-span-12"
        [addonWidth]="addonWidth"
      />
      <app-text-input
        placeholder="عنوان"
        label="عنوان"
        validationField="title"
        class="col-span-12"
        [control]="ladPlacesTitle"
        [addonWidth]="addonWidth"
      />
      <app-text-input
        [control]="ladPlacesTel"
        label="تلفن"
        placeholder="تلفن"
        validationField="telephone"
        class="col-span-12"
        [addonWidth]="addonWidth"
      />
      <app-text-input
        label="آدرس"
        class="col-span-12"
        icon="pi pi-card-id"
        validationField="address"
        [control]="ladPlacesAddress"
        [addonWidth]="addonWidth"
      />
      <div class="grid grid-cols-12 gap-4 col-span-12">
        <app-toggle-switch-input
          label="وضعیت مبدا بارگیری"
          [control]="loadingActive"
          class="col-span-12 flex px-2"
        />
        <app-toggle-switch-input
          label="وضعیت مقصد بارگیری"
          [control]="dischargingActive"
          class="col-span-12 flex px-2"
        />
      </div>
    </div>
    <div class="col-span-12 flex justify-end">
      <p-button
        (click)="registerOrEdit()"
        label="ثبت و ویرایش اطلاعات"
        [disabled]="ladPlacesForm.invalid || loading"
      />
    </div>
  </form>
</p-dialog>
