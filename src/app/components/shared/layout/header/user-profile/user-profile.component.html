<!-- User Profile / Skeleton Loader Container -->
<div
  class="flex h-10 gap-2 rounded-md border shadow-md bg-button-secondary text-button-secondary hover:bg-button-secondary-hover transition-all"
>
  <!-- Skeleton State -->
  <div
    *ngIf="!isUserProfileLoad(); else loadedProfile"
    class="flex justify-center items-center"
  >
    <!-- Wallet Icon -->
    <p-avatar
      icon="pi pi-user"
      shape="square"
      size="normal"
      class="w-10 h-full"
    />
    <div class="h-full w-0.5 bg-gray-600 ml-1"></div>
    <div class="flex flex-col gap-1 px-1">
      <p-skeleton width="8rem" />
      <p-skeleton height=".5rem" />
    </div>
  </div>
  <!-- Loaded State -->
  <ng-template #loadedProfile>
    <div
      (click)="op.toggle($event)"
      class="flex items-center cursor-pointer rounded-2xl"
    >
      <!-- Avatar -->
      <p-avatar
        icon="pi pi-user"
        shape="square"
        size="normal"
        class="w-10 h-full"
      />

      <div class="h-full w-0.5 bg-gray-600 ml-2"></div>

      <!-- Username -->
      <div class="flex gap-2 items-center text-sm pl-2 py-1 rounded-2xl">
        <span>{{ profile()?.UserName }}</span>
        <i class="pi pi-angle-down text-xs mt-1"></i>
      </div>
    </div>
  </ng-template>
</div>

<!-- Popover Menu -->
<p-popover #op>
  <div class="w-64 p-4 rounded-xl flex flex-col gap-3 font-medium" dir="rtl">
    <!-- User Info Header -->
    <div class="flex items-center gap-3 border-b pb-3">
      <div
        class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-lg font-bold text-gray-600"
      >
        {{ profile()?.UserName?.slice(0, 2) }}
      </div>
      <div class="flex flex-col">
        <span class="text-base">{{ profile()?.UserName }}</span>
        <span class="text-sm text-gray-500">{{ profile()?.MobileNumber }}</span>
      </div>
    </div>

    <!-- Profile Button -->
    <button
      (click)="openProfile(op)"
      class="w-full flex flex-row-reverse items-center justify-end gap-2 px-3 py-2 rounded-lg hover:bg-emphasis transition-colors"
    >
      <span>پروفایل من</span>
      <i class="pi pi-user text-gray-500"></i>
    </button>

    <!-- Logout Button -->
    <p-button
      severity="danger"
      variant="text"
      styleClass="w-full flex flex-row-reverse items-center justify-end gap-2 px-3 py-2 rounded-lg"
      (click)="logout(op)"
    >
      <span>خروج</span>
      <i class="pi pi-sign-out mt-1 text-red-500"></i>
    </p-button>
  </div>
</p-popover>
