<app-button
  styleClass="fixed bottom-0 left-0 py-5 text-2xl font-bold mb-8 ml-4"
  severity="info"
  [rounded]="true"
  icon="pi pi-phone"
  size="large"
  (click)="showDialog()"
/>

<p-dialog
  header="روش های ارتباطی با سامانه"
  [modal]="true"
  [(visible)]="visible"
  draggable="false"
  styleClass="rounded-4xl"
>
  <div class="flex flex-col items-center gap-4">
    <div class="flex flex-col items-center gap-2">
      @for (item of contactList(); track $index) {
        <app-button
          (click)="CallUsOnPhone.toggle($event)"
          icon="pi pi-phone"
          [label]="item.title"
          severity="info"
          styleClass="w-full"
          class="w-full"
        />
        <p-popover
          styleClass="rounded-4xl"
          [dt]="{
            arrowOffset: '35px',
          }"
          #CallUsOnPhone
        >
          <div class="flex flex-col gap-4 justify-center items-center">
            @for (number of item.numbers; track $index) {
              <div class="flex items-center w-full justify-end gap-3">
                <span [textContent]="number"></span>
                <p-button
                  severity="info"
                  [raised]="true"
                  icon="pi pi-clipboard"
                  (onClick)="copyToClipboard(number)"
                  styleClass="rounded-full"
                />
                <a href="tel:{{ number }}">
                  <p-button
                    severity="info"
                    [raised]="true"
                    icon="pi pi-phone"
                    styleClass="rounded-full"
                /></a>
              </div>
            }
          </div>
        </p-popover>
      }
    </div>

    <div class="m-2 items-center justify-center">
      <app-button
        (click)="showTicketDialog()"
        label="ارتباط مستقیم با پشتیبانی"
        icon="pi pi-headphones"
        severity="info"
      />
    </div>
  </div>
</p-dialog>

<!-- Ticket -->

<p-dialog
  draggable="false"
  header="ارتباط با پشتیبانی"
  [modal]="true"
  [(visible)]="dialog"
>
  <!-- Info text -->

  <div class="space-y-4 mb-6">
    <!-- ثبت تیکت جدید -->
    <div>
      <div class="font-bold text-gray-800 dark:text-gray-200">
        ثبت تیکت جدید
      </div>
      <div class="text-gray-600 dark:text-gray-400">
        برای ارسال درخواست پشتیبانی و ارتباط با تیم ما، دکمه زیر را انتخاب کنید.
      </div>
    </div>

    <!-- پیگیری تیکت -->
    <div>
      <div class="font-bold text-gray-800 dark:text-gray-200">پیگیری تیکت</div>
      <div class="text-gray-600 dark:text-gray-400">
        برای بررسی سریع و آسان وضعیت درخواست‌های قبلی، دکمه پیگیری را کلیک کنید.
      </div>
    </div>
  </div>

  <!-- Centered buttons: Create / Track -->
  <div class="flex justify-center gap-4 my-5 px-5">
    <app-button
      class="flex-1"
      label="ایجاد تیکت"
      severity="primary"
      styleClass="w-full"
      (click)="redirectUrl(APP_ROUTS.TICKET.CREATE)"
    />

    <app-button
      class="flex-1"
      label="پیگیری تیکت"
      severity="info"
      styleClass="w-full"
      (click)="redirectUrl(APP_ROUTS.TICKET.TRACK)"
    />
  </div>

  <!-- Cancel button on left bottom -->
  <div class="flex justify-end mt-10">
    <app-button label="انصراف" severity="warn" (click)="dialog = false" />
  </div>
</p-dialog>

<app-ticket-guard-captcha-form
  (hiddenDialog)="activeCaptcha.set(false)"
  [activeCaptcha]="activeCaptcha()"
  [action]="captchaAction()"
/>
