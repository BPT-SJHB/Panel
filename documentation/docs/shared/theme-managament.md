---
sidebar_position: 31
title: ThemeManagement
---

# 🎨 Theme Management Component

کامپوننت `ThemeManagementComponent` یک جزء رابط کاربری کوچک و ضروری است که به کاربر اجازه می‌دهد تم برنامه (Theme) را بین حالت **روشن (Light)** و **تاریک (Dark)** جابه‌جا کند. این کامپوننت وضعیت تم را در حافظه محلی مرورگر (LocalStorage) ذخیره می‌کند و با استفاده از **`signal`**، آیکون نمایش داده شده را به‌روز می‌کند.

## ⚙️ ساختار و معماری

- **Imports**: تنها از `ButtonModule` (PrimeNG) برای پیاده‌سازی دکمه سوئیچ تم استفاده می‌کند.
- **Signals**: از سیگنال **`icon`** برای مدیریت نمایش آیکون مربوطه (`pi-sun` یا `pi-moon`) استفاده می‌کند.

## 🧠 منطق و مدیریت حالت

### ۱. مقداردهی اولیه تم (`setInitialTheme`)

این متد در `constructor` کامپوننت اجرا می‌شود تا وضعیت تم را در اولین بارگذاری برنامه مشخص کند:

1.  **بررسی LocalStorage**: ابتدا `theme` ذخیره‌شده در `localStorage` را بررسی می‌کند.
2.  **بررسی تنظیمات سیستم**: اگر تمی در `localStorage` وجود نداشت، تنظیمات ترجیحی کاربر در سیستم عامل (`window.matchMedia('(prefers-color-scheme: dark)')`) را بررسی می‌کند.
3.  **اعمال کلاس**: کلاس **`dark`** را روی تگ اصلی `<html>` اعمال می‌کند (که توسط CSS/Tailwind برای اعمال استایل‌های تاریک استفاده می‌شود).
4.  **تنظیم آیکون**: آیکون `pi-sun` (برای تم تاریک فعال) یا `pi-moon` (برای تم روشن فعال) را روی سیگنال `icon` تنظیم می‌کند.

### ۲. تغییر وضعیت تم (`toggleTheme`)

این متد هنگام کلیک روی دکمه توسط کاربر فراخوانی می‌شود:

1.  **جابه‌جایی کلاس**: با استفاده از **`html?.classList.toggle('dark')`**، کلاس `dark` را از تگ `<html>` حذف یا به آن اضافه می‌کند. این تابع وضعیت جدید (آیا `dark` فعال شد؟) را برمی‌گرداند.
2.  **به‌روزرسانی UI و LocalStorage**:
    - اگر تم تاریک **فعال** شده باشد: آیکون را به **خورشید (`pi-sun`)** و `localStorage` را به `'dark'` تنظیم می‌کند.
    - اگر تم روشن **فعال** شده باشد: آیکون را به **ماه (`pi-moon`)** و `localStorage` را به `'light'` تنظیم می‌کند.

## 📄 خلاصه جریان کار

| متد                     | فراخوانی توسط       | وظیفه اصلی                                                               |
| :---------------------- | :------------------ | :----------------------------------------------------------------------- |
| **`setInitialTheme()`** | `constructor`       | بازیابی تم ذخیره‌شده یا ترجیحی سیستم و اعمال آن به `<html>`.             |
| **`toggleTheme()`**     | رویداد `click` دکمه | جابه‌جایی کلاس `dark` روی `<html>` و ذخیره وضعیت جدید در `localStorage`. |
