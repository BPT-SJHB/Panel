---
sidebar_position: 22
title: Header
---

# 👤 Header Component

کامپوننت `HeaderComponent` نوار اصلی بالای داشبورد را مدیریت می‌کند. وظیفه اصلی آن نمایش اطلاعات حیاتی برنامه (مانند عنوان و آیکون صفحه فعال)، مدیریت وضعیت پروفایل و کیف پول کاربر، و فراهم کردن دسترسی به تنظیمات مهم مانند نوار کناری و تم است.

---

## ⚙️ ساختار و وابستگی‌ها

- **NgRx Store**: برای دریافت داده‌های محتوای فعال (`selectContent`) و ارسال اکشن `openSidebar()`.
- **Services**: از `UserManagementService` برای بارگذاری اطلاعات پروفایل و کیف پول استفاده می‌کند.
- **Sub-Components**: از کامپوننت‌های مستقل مانند `UserProfileComponent`، `WalletProfileComponent`، `ThemeManagementComponent` و `FrameHeaderComponent` برای نمایش بخش‌های مختلف استفاده می‌کند.

## 🧠 مدیریت حالت و داده‌ها

این کامپوننت از Signals برای مدیریت داده‌های پویا و RxJS برای مدیریت جریان داده‌های استور استفاده می‌کند.

| ویژگی            | نوع                      | منبع                                   | توضیح                                                                              |
| :--------------- | :----------------------- | :------------------------------------- | :--------------------------------------------------------------------------------- |
| **`profile`**    | `signal<... \| null>`    | `userService.GetSoftwareUserProfile()` | اطلاعات پروفایل کاربر فعال که در نوار بالا نمایش داده می‌شود.                      |
| **`wallet`**     | `signal<Wallet \| null>` | `userService.GetSoftwareUserProfile()` | اطلاعات مربوط به موجودی کیف پول کاربر.                                             |
| **`headerData`** | `HeaderData`             | `store.select(selectContent)`          | عنوان و آیکون محتوای فعال فعلی (مانند تب یا صفحه) که از `TabManager` ارسال می‌شود. |

## 🛠️ توابع و متدهای کلیدی

### ۱. توابع عمومی و تعاملی

| متد                 | نوع    | توضیح                                                                                                                                 |
| :------------------ | :----- | :------------------------------------------------------------------------------------------------------------------------------------ |
| **`openSidebar()`** | `void` | هنگام کلیک بر روی دکمه همبرگری (یا معادل آن)، اکشن **`openSidebar()`** را به NgRx Store ارسال می‌کند تا نوار کناری (Sidebar) باز شود. |

### ۲. توابع مدیریت داده و چرخه حیات

| متد                     | نوع             | توضیح                                                                                                                                                                                                                                  |
| :---------------------- | :-------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`ngOnInit()`**        | `void`          | هنگام راه‌اندازی کامپوننت، متد **`loadUserProfile()`** را برای واکشی اطلاعات پروفایل و کیف پول کاربر فراخوانی می‌کند.                                                                                                                  |
| **`ngAfterViewInit()`** | `void`          | سابسکریپشن NgRx به **`selectContent`** را راه‌اندازی می‌کند. این سابسکریپشن عنوان (`title`) و آیکون (`icon`) محتوای فعال را دریافت کرده و متغیر **`this.headerData`** را به‌روز می‌کند.                                                |
| **`ngOnDestroy()`**     | `void`          | سابسکریپشن مربوط به استور (`this.render$`) را **لغو اشتراک** می‌کند تا از نشت حافظه (Memory Leak) جلوگیری شود.                                                                                                                         |
| **`loadUserProfile()`** | `Promise<void>` | اطلاعات پروفایل و کیف پول کاربر را از طریق `UserManagementService` واکشی می‌کند. اگر خطایی رخ دهد، از `checkAndToastError` برای نمایش پیام خطا استفاده کرده و در صورت موفقیت، سیگنال‌های **`profile`** و **`wallet`** را تنظیم می‌کند. |
