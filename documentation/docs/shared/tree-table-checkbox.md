---
sidebar_position: 26
title: TreeTableCheckbox
---

# ๐ณ Tree Table Checkbox Component

ฺฉุงููพูููุช `TreeTableCheckboxComponent` ฺฉ ฺฉุงููพูููุช UI ูุฌุฏุฏ ุงุณุชูุงุฏูโูพุฐุฑ ุจุฑุง ููุงุด ุฏุงุฏูโูุง ุณูุณููโูุฑุงุชุจ (ุฏุฑุฎุช) ุงุณุช. ุงู ฺฉุงููพูููุช ุจุง ุงุณุชูุงุฏู ุงุฒ **`TreeTable` PrimeNG** ู ููุทู ุฏุงุฎู ุฎูุฏุ ุงูฺฉุงู ุงูุชุฎุงุจ ููุงุฑุฏ (ุจุง ฺฺฉโุจุงฺฉุณ) ุฏุฑ ุณุทูุญ ูุงูุฏ ู ูุฑุฒูุฏ ุฑุง ูุฑุงูู ูโฺฉูุฏุ ููฺูู ูุงุจูุชโูุง **ุตูุญูโุจูุฏ (Paginator)** ู **ุฌุณุชุฌู ูพุดุฑูุชู** ุฑุง ูุฒ ุงุฑุงุฆู ูโุฏูุฏ.

## โ๏ธ ูุฑูุฏโูุง (Inputs) ู ุฎุฑูุฌโูุง (Outputs)

| ูุงู                               | ููุน                    | ูพุดโูุฑุถ | ุชูุถุญ                                                                                                               |
| :-------------------------------- | :--------------------- | :------ | :------------------------------------------------------------------------------------------------------------------ |
| `@Input() tree`                   | `TreeNode[]`           | `[]`    | ุณุงุฎุชุงุฑ ุฏุฑุฎุช ุงุตู ุฏุงุฏูโูุง ฺฉู ุจุงุฏ ููุงุด ุฏุงุฏู ุดูุฏ.                                                                   |
| `@Input() parentField`            | `string`               | `''`    | ูุงู ููุฏ ุฏุฑ ุขุจุฌฺฉุช `data` ูุงูุฏ ฺฉู ูุถุนุช ุงูุชุฎุงุจ (Checked/Partial) ุขู ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.                                |
| `@Input() childField`             | `string`               | `''`    | ูุงู ููุฏ ุฏุฑ ุขุจุฌฺฉุช `data` ูุฑุฒูุฏ ฺฉู ูุถุนุช ุงูุชุฎุงุจ (Checked) ุขู ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.                                       |
| `@Input() cols`                   | `string[]`             | `[]`    | ูุณุช ุนููุงู ุณุชููโูุง ุจุฑุง ููุงุด ุฏุฑ ุฌุฏูู.                                                                              |
| `@Input() enabledSearch`          | `boolean`              | `false` | ุขุง ุจุงฺฉุณ ุฌุณุชุฌู ูุนุงู ุจุงุดุฏ ุง ุฎุฑ.                                                                                    |
| `@Input() enabledAutoSearch`      | `boolean`              | `true`  | ุงฺฏุฑ `true` ุจุงุดุฏุ ุฌุณุชุฌู ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ููฺฏุงู ุชุงูพ ุงูุฌุงู ูโุดูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุจู ฺฉูฺฉ ุฑู ุฏฺฉูู ุฌุณุชุฌู ูุงุฒ ุฏุงุฑุฏ.    |
| `@Input() searchFields`           | `string[]`             | `[]`    | ููุฏูุง ุงุฒ ุฏุงุฏูโูุง ฺฉู ุฌุณุชุฌู ุจุงุฏ ุฑู ุขูโูุง ุงุนูุงู ุดูุฏ.                                                              |
| `@Output() onTableCheckBoxChange` | `EventEmitter<...>`    | -       | ุฒูุงู ฺฉู ูุถุนุช ฺฺฉโุจุงฺฉุณ ูุฑ ฺฏุฑูโุง ุชุบุฑ ูโฺฉูุฏุ ูุนุงู ูโุดูุฏ ู ุฏุงุฏูโูุง ุชุบุฑ ุงูุชู (ูุงูุฏ ู ูุฑุฒูุฏุงู) ุฑุง ุงุฑุณุงู ูโฺฉูุฏ. |
| `@Output() onSearch`              | `EventEmitter<string>` | -       | ุฒูุงู ฺฉู ฺฉ ุนููุงุช ุฌุณุชุฌู (ุฏุณุช ุง ุฎูุฏฺฉุงุฑ) ุงูุฌุงู ูโุดูุฏุ ูุนุงู ุดุฏู ู ุฑุดุชู ุฌุณุชุฌู ุฑุง ุงุฑุณุงู ูโฺฉูุฏ.                      |

---

## ๐ง ูุฏุฑุช ุญุงูุช ู ููุทู ฺฺฉโุจุงฺฉุณ

ุงู ฺฉุงููพูููุช ุงุฒ ุฏู ุณุงุฎุชุงุฑ ุฏุงุฏู ฺฉูุฏ ุจุฑุง ูุฏุฑุช ุงูุชุฎุงุจโูุง ู ุจุงุฒุงุจ ุณุฑุน ฺฏุฑูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ:

### ฑ. ุณุงุฎุชุงุฑูุง ุฏุงุฏู ุฏุงุฎู

| ูุงู                          | ููุน                            | ุชูุถุญ                                                                                                                                                                     |
| :--------------------------- | :----------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **`treeMap`**                | `Map<string, TreeNode>`        | ฺฉ Map ฺฉู ุชูุงู ฺฏุฑูโูุง ุฏุฑุฎุช ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ `key` ููุญุตุฑ ุจู ูุฑุฏุดุงู (ุชููุฏ ุดุฏู ุชูุณุท ูุชุฏ `setKeysRecursively`) ููุฑุณุช ูโฺฉูุฏ. ุงู ุณุงุฎุชุงุฑ ุจุฑุง ุจุงุฒุงุจ ุณุฑุน ฺฏุฑูโูุง ุถุฑูุฑ ุงุณุช. |
| **`selectionKeys`**          | `Record<string, SelectionKey>` | ุขุจุฌฺฉุช ฺฉู ุชูุณุท `TreeTable` PrimeNG ุจุฑุง ูพฺฏุฑ ูุถุนุช ุงูุชุฎุงุจ ูุฑ ฺฏุฑู ุงุณุชูุงุฏู ูโุดูุฏ (Checkedุ PartialChecked ู isHidden).                                                   |
| **`lastSelectionKeys`**      | `Record<string, SelectionKey>` | ฺฉ ฺฉูพ ุงุฒ ูุถุนุช `selectionKeys` ุฏุฑ ุขุฎุฑู ุนููุงุช ููููุ ุจุฑุง ุชุนู ุฏูู ุงูฺฉู ฺฉุฏุงู ฺฏุฑู ุชุบุฑ ฺฉุฑุฏู ุงุณุช.                                                                      |
| **`SelectionKey` Interface** | -                              | ุชุนุฑู ุฏุงุฎู ูุถุนุช ฺฏุฑู: `{ checked: boolean, partialChecked?: boolean, isHidden: boolean }`.                                                                               |

### ฒ. ุชูุงุจุน ุงุตู ูุฏุฑุช ฺฺฉโุจุงฺฉุณ

| ูุชุฏ                                  | ููุน          | ุชูุถุญ                                                                                                                                                                                                                                                                      |
| :----------------------------------- | :----------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`initializeTree()`**               | `TreeNode[]` | ุฏุฑุฎุช ูุฑูุฏ (`@Input() tree`) ุฑุง ูพุฑุฏุงุฒุด ุงููู ูโฺฉูุฏ. ุงู ูุชุฏ `selectionKeys` ุฑุง ุจุงุฒูุดุงู ฺฉุฑุฏู ู ุจุง ูุฑุงุฎูุงู `setKeysRecursively` ฺฉูุฏูุง ููุญุตุฑ ุจู ูุฑุฏ ุฑุง ุจู ฺฏุฑูโูุง ุงุฎุชุตุงุต ูโุฏูุฏ.                                                                                          |
| **`setKeysRecursively(node, path)`** | `TreeNode`   | **ููุทู ุงุตู** ุจุฑุง ุชููุฏ `key`ูุง ููุญุตุฑ ุจู ูุฑุฏ ุจุฑุง ูุฑ ฺฏุฑู (ุจูโุตูุฑุช ุณูุณููโูุฑุงุชุจ: `0-0-1`) ู ุชุนู ูุถุนุช ุงููู ฺฺฉโุจุงฺฉุณโูุง ุจุฑ ุงุณุงุณ ุฏุงุฏูโูุง ูุฑูุฏ (`parentField` ู `childField`). ุงู ูุชุฏ ูุถุนุช `partialChecked` ุฑุง ูุฒ ูุญุงุณุจู ูโฺฉูุฏ.                                      |
| **`selectionKeysChanged(newKeys)`**  | `void`       | ูููโุชุฑู ูุชุฏ ุจุฑุง ูุฏุฑุช ุฎุฑูุฌ. ุงู ูุชุฏ ุชูุงูุช ุจู `lastSelectionKeys` ู `newKeys` ุฑุง ูพุฏุง ูโฺฉูุฏุ ูุดุฎุต ูโฺฉูุฏ ฺฉุฏุงู ูุงูุฏ ู ฺฉุฏุงู ูุฑุฒูุฏ ุชุบุฑ ฺฉุฑุฏูโุงูุฏุ ู ุฏุงุฏูโูุง ุงุตู ฺฏุฑูโูุง ุฑุง ุฏุฑ ุขู ููุฏูุง ุจูโุฑูุฒุฑุณุงู ูโฺฉูุฏ. ุฏุฑ ููุงุช ุฎุฑูุฌ **`onTableCheckBoxChange`** ุฑุง ูุนุงู ูโฺฉูุฏ. |

---

## ๐ ููุทู ุฌุณุชุฌู ู ููุชุฑ (Filtering)

| ูุชุฏ                     | ููุน    | ุชูุถุญ                                                                                                                                                                                                                                                       |
| :---------------------- | :----- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`filterTree(query)`** | `void` | ุงุฒ ุทุฑู ฺฉุงููพูููุช ูุฑูุฏ ุฌุณุชุฌู ูุฑุงุฎูุงู ูโุดูุฏ. ุงฺฏุฑ `enabledAutoSearch` ูุนุงู ุจุงุดุฏุ ููุชุฑ ุฑุง ุงุนูุงู ูโฺฉูุฏ.                                                                                                                                                     |
| **`onClickSearch()`**   | `void` | ุชููุง ุฒูุงู ูุฑุงุฎูุงู ูโุดูุฏ ฺฉู `enabledAutoSearch` ุบุฑูุนุงู ุจุงุดุฏ.                                                                                                                                                                                             |
| **`filters(query)`**    | `void` | **ููุทู ููุชุฑ ุฏุงุฎู.** ฺฏุฑูโูุง ุฏุฑุฎุช ุฑุง ุจูโุตูุฑุช ฺฉุงูู ููุชุฑ ูโฺฉูุฏ. ุงฺฏุฑ ฺฉ ูุงูุฏ ุจุง ฺฉูุฆุฑ ุฌุณุชุฌู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ _ุง_ ุญุฏุงูู ฺฉ ุงุฒ ูุฑุฒูุฏุงู ุขู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดูุฏุ ูุงูุฏ ููุงุด ุฏุงุฏู ูโุดูุฏ. ฺฏุฑูโูุง ฺฉู ูุทุงุจูุช ูุฏุงุฑูุฏุ ุจุง ุงุนูุงู ฺฉูุงุณ **`hidden`** ูพููุงู ูโุดููุฏ. |

## ๐ ฺุฑุฎูโุญุงุช (Lifecycle Hooks)

| ูุชุฏ                              | ุชูุถุญ                                                                                                           |
| :------------------------------- | :-------------------------------------------------------------------------------------------------------------- |
| **`ngOnInit()`**                 | ุฏุฑุฎุช ุฑุง ููุฏุงุฑุฏู ุงููู ฺฉุฑุฏู (`initializeTree`)ุ `treeMap` ุฑุง ูโุณุงุฒุฏ ู `lastSelectionKeys` ุฑุง ุชูุธู ูโฺฉูุฏ.     |
| **`ngOnChanges(changes)`**       | ุงฺฏุฑ `@Input() tree` ุชุบุฑ ฺฉูุฏุ ุชูุงู ูุฑุขูุฏโูุง ููุฏุงุฑุฏู ุงููู (Initialization) ู ุณุงุฎุช ุฏุฑุฎุช ูุฌุฏุฏุงู ุงูุฌุงู ูโุดูุฏ. |
| **`@ViewChild('treeTable') tt`** | ุงูฺฉุงู ุฏุณุชุฑุณ ูุณุชูู ุจู ุงูุณุชูุณ `TreeTable` PrimeNG ุฑุง ุจุฑุง ฺฉูุชุฑูโูุง ูพุดุฑูุชู (ุงฺฏุฑ ูุงุฒู ุจุงุดุฏ) ูุฑุงูู ูโฺฉูุฏ.      |

ูุทุนุงู. ุจุฑุง ฺฉุงููพูููุช `TreeTableCheckboxComponent` ฺฉู ฺฉ ุฌุฏูู ุฏุฑุฎุช ูพุดุฑูุชู ุจุง ฺฺฉโุจุงฺฉุณ ุงุณุชุ ุฏุฑ ุฒุฑ ููููู ฺฉุฏ HTML ุงุณุชูุงุฏู ุงุฒ ุขู ุฏุฑ ฺฉ ฺฉุงููพูููุช ูุงูุฏ ุจู ููุฑุงู ูุญูู ุชุนุฑู ุฏุงุฏูโูุง ูุงุฒู ุฏุฑ TypeScript ุขูุฑุฏู ุดุฏู ุงุณุช.

---

## ๐ ููููู ฺฉุฏ ุงุณุชูุงุฏู ุงุฒ TreeTableCheckboxComponent

ุงู ูุซุงู ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ูโุชูุงู ุงุฒ `TreeTableCheckboxComponent` ุจุฑุง ูุฏุฑุช ุณูุณููโูุฑุงุชุจ ููุดโูุง (Permissions) ุฏุฑ ฺฉ ุณุณุชู ุงุณุชูุงุฏู ฺฉุฑุฏุ ุฌุง ฺฉู ูุงูุฏู (ูุงฺููโูุง) ู ูุฑุฒูุฏุงู (ูุฌูุฒูุง ุฏุณุชุฑุณ) ูุฌูุฏ ุฏุงุฑูุฏ.

### ฑ. ูุฏูโูุง ุฏุงุฏูโุง ููุฑุฏ ูุงุฒ (TypeScript)

ูุฑุถ ูโฺฉูู ุฏุงุฏูโูุง ูุง ุจู ุงู ุดฺฉู ุณุงุฎุชุงุฑ ุงูุชูโุงูุฏ:

```typescript
// permission.model.ts
export interface Permission {
  id: number;
  name: string;
  canAccess: boolean; // ููุฏ ุจุฑุง ูุฑุฒูุฏุงู
}

export interface Module {
  id: number;
  name: string;
  isManaged: boolean; // ููุฏ ุจุฑุง ูุงูุฏ
  permissions: Permission[];
}
```

### ฒ. ฺฉุงููพูููุช ูุงูุฏ (Parent Component)

```typescript
// role-permissions.component.ts
import { Component, OnInit } from "@angular/core";
import { TreeNode } from "primeng/api";
import { TreeTableChangedData } from "app/components/shared/tree-table-checkbox/tree-table-checkbox.component";
import { Module, Permission } from "./permission.model";
import { ToastService } from "app/services/toast-service/toast.service";

@Component({
  selector: "app-role-permissions",
  templateUrl: "./role-permissions.component.html",
  // ...
})
export class RolePermissionsComponent implements OnInit {
  private toast = inject(ToastService);

  // 1. ุชุนุฑู ุฏุงุฏูโูุง ุฎุงู
  rawModules: Module[] = [
    {
      id: 1,
      name: "ูุฏุฑุช ฺฉุงุฑุจุฑุงู",
      isManaged: true,
      permissions: [
        { id: 101, name: "ุงูุฒูุฏู ฺฉุงุฑุจุฑ", canAccess: true },
        { id: 102, name: "ุญุฐู ฺฉุงุฑุจุฑ", canAccess: false },
        { id: 103, name: "ูุดุงูุฏู ูุงฺฏ", canAccess: true },
      ],
    },
    {
      id: 2,
      name: "ูุฏุฑุช ุชฺฉุชโูุง",
      isManaged: false,
      permissions: [
        { id: 201, name: "ุงุฑุณุงู ุชฺฉุช", canAccess: true },
        { id: 202, name: "ุจุณุชู ุชฺฉุช", canAccess: false },
      ],
    },
  ];

  // 2. ุณุงุฎุชุงุฑ ุฏุฑุฎุช (TreeNode[])
  permissionTree: TreeNode[] = [];

  // 3. ูพฺฉุฑุจูุฏ ุณุชููโูุง ุจุฑุง ููุงุด
  tableColumns = ["ูุงฺูู / ูุฌูุฒ", "ูุถุนุช ุฏุณุชุฑุณ"];

  // 4. ููุฏูุง ุฌุณุชุฌู
  searchFields = ["name"];

  ngOnInit(): void {
    this.permissionTree = this.buildPermissionTree(this.rawModules);
  }

  private buildPermissionTree(modules: Module[]): TreeNode[] {
    return modules.map((mod) => ({
      data: mod,
      expanded: true, // ุจุงุฒ ุจูุฏู ูพุดโูุฑุถ ฺฏุฑูโูุง ูุงูุฏ
      children: mod.permissions.map((perm) => ({
        data: perm,
      })),
    }));
  }

  // 5. ููุฏู ฺฉุฑุฏู ุชุบุฑุงุช ฺฺฉโุจุงฺฉุณ
  onPermissionChange(data: TreeTableChangedData) {
    if (data.parent) {
      console.log("ูุงูุฏ ุชุบุฑ ฺฉุฑุฏ:", data.parent);
      this.toast.info(
        "ุชุบุฑ ูุงูุฏ",
        `ูุถุนุช ูุงฺูู ${data.parent.name} ุจู ${data.parent.isManaged} ุชุบุฑ ฺฉุฑุฏ.`
      );
    }
    if (data.children.length > 0) {
      console.log("ูุฑุฒูุฏุงู ุชุบุฑ ฺฉุฑุฏูุฏ:", data.children);
      this.toast.info(
        "ุชุบุฑ ูุฌูุฒ",
        `ุชุนุฏุงุฏ ${data.children.length} ูุฌูุฒ ุจูโุฑูุฒุฑุณุงู ุดุฏ.`
      );
    }
    // ุฏุฑ ุงูุฌุง ุจุงุฏ API ุจุฑุง ุฐุฎุฑู ุชุบุฑุงุช ูุฑุงุฎูุงู ุดูุฏ
  }

  onSearch(query: string) {
    console.log("ุฌุณุชุฌู ุงุนูุงู ุดุฏ:", query);
    // ููุทู ุงุถุงู ุณูุช ุณุฑูุฑ (ุฏุฑ ุตูุฑุช ูุฒูู)
  }
}
```

### ณ. ูุงูุจ HTML (ุงุณุชูุงุฏู ุงุฒ ฺฉุงููพูููุช)

```html
<div class="p-card p-4">
  <h3>ุชูุธู ุฏุณุชุฑุณโูุง ููุด</h3>
  <p>ุฏุณุชุฑุณโูุง ูุฑ ูุงฺูู ุฑุง ุจุฑุง ุงู ููุด ูุฏุฑุช ฺฉูุฏ.</p>

  <app-tree-table-checkbox
    [tree]="permissionTree"
    [cols]="tableColumns"
    [parentField]="'isManaged'"
    [childField]="'canAccess'"
    [enabledSearch]="true"
    [searchFields]="searchFields"
    searchPlaceholder="ุฌุณุชุฌู ุจุฑ ุงุณุงุณ ูุงู ูุงฺูู ุง ูุฌูุฒ..."
    [paginator]="true"
    [rowsPerPage]="5"
    (onTableCheckBoxChange)="onPermissionChange($event)"
    (onSearch)="onSearch($event)"
  ></app-tree-table-checkbox>
</div>
```
