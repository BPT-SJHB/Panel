---
sidebar_position: 29
title: UserProfile
---

# 🧑‍💻 User Profile Component

کامپوننت `UserProfileComponent` یک جزء رابط کاربری کوچک و متمرکز است که در نوار بالایی برنامه قرار می‌گیرد. این کامپوننت وظیفه نمایش **آواتار** یا اطلاعات اولیه کاربر را دارد و با کلیک بر روی آن، یک **Popover** حاوی گزینه‌های مهم مانند "مشاهده پروفایل" و "خروج از سیستم" باز می‌شود.

---

## ⚙️ معماری و وابستگی‌ها

- **Input**: این کامپوننت مستقیماً داده‌های پروفایل کاربر را از کامپوننت والد (مانند `HeaderComponent`) دریافت می‌کند.
- **PrimeNG**:
  - `AvatarModule`: برای نمایش آواتار کاربر.
  - `SkeletonModule`: برای نمایش حالت بارگذاری (Skeleton) در هنگام واکشی داده‌ها.
  - `Popover`: برای نمایش منوی گزینه‌های پروفایل.
- **NgRx Store**: برای ارسال اکشن `createTab` هنگام کلیک بر روی گزینه "مشاهده پروفایل".
- **Services**: از `UserAuthService` برای مدیریت عملیات خروج از سیستم استفاده می‌کند.

## 📥 ورودی‌ها و سیگنال‌ها

| نام                     | نوع                           | توضیح                                                                                                                                                     |
| :---------------------- | :---------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `@Input() profile`      | `WritableSignal<... \| null>` | یک سیگنال که آبجکت پروفایل کاربر (`RawSoftwareUserForProfile`) را از کامپوننت والد دریافت می‌کند. وجود مقدار `null` نشان‌دهنده حالت بارگذاری است.         |
| **`isUserProfileLoad`** | `Computed<boolean>`           | یک سیگنال محاسباتی که وضعیت بارگذاری پروفایل را مشخص می‌کند (`true` اگر `profile()` نال نباشد). این برای نمایش `Skeleton` در حین بارگذاری استفاده می‌شود. |

## 🛠️ توابع و منطق کلیدی

| متد                                 | نوع    | توضیح                                                                                                                                                                                                            |
| :---------------------------------- | :----- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`logout(popover: Popover)`**      | `void` | کاربر را از سیستم خارج می‌کند (با استفاده از `UserAuthService.logout()`) و سپس Popover را می‌بندد.                                                                                                               |
| **`openProfile(popover: Popover)`** | `void` | اکشن **`createTab`** را به NgRx Store ارسال می‌کند تا تب مربوط به مدیریت پروفایل کاربر (`TabComponentKey.UserProfileManagement`) در `TabManagerComponent` باز یا فعال شود. پس از ارسال اکشن، Popover را می‌بندد. |

## 🎭 مدیریت حالت بارگذاری (Skeleton)

این کامپوننت با مشاهده وضعیت `isUserProfileLoad()`، یکی از دو حالت زیر را در UI نمایش می‌دهد:

1.  **حالت بارگذاری:** اگر `isUserProfileLoad()` برابر با `false` باشد، یک کامپوننت **`Skeleton`** (در قالب یک دایره آواتار) نمایش داده می‌شود تا کاربر از فرآیند واکشی داده‌ها مطلع شود.
2.  **حالت عادی:** اگر `isUserProfileLoad()` برابر با `true` باشد، آواتار واقعی کاربر به همراه منوی Popover نمایش داده می‌شود.
